source variables.scr
# This file analyze, elaborate and compile vhdl file

# -f indica il formato dei file
# -lib indica dove mettere i file su cui lavora sysnopsys


analyze -f vhdl -lib WORK {../src/VHDL_Packages/Conv_pkg.vhd ../src/VHDL_Packages/FC_pkg.vhd ../src/VHDL_Common/clock_gating.vhd ../src/VHDL_Common/comparator.vhd ../src/VHDL_Common/Counter_N_FC.vhd ../src/VHDL_Common/Counter_N.vhd ../src/VHDL_Common/CU_TOT.vhd ../src/VHDL_Common/Input_registers.vhd ../src/VHDL_Common/Intermediate_Registers_1.vhd ../src/VHDL_Common/Intermediate_Registers_2.vhd ../src/VHDL_Common/latch_nbit.vhd ../src/VHDL_Common/latch_n.vhd ../src/VHDL_Common/LeNet5_top.vhd ../src/VHDL_Common/mac_block.vhd ../src/VHDL_Common/mux25to1_nbit.vhd ../src/VHDL_Common/mux2to1_nbit.vhd ../src/VHDL_Common/mux2to1.vhd ../src/VHDL_Common/mux4to1_bit.vhd ../src/VHDL_Common/mux4to1_nbit.vhd ../src/VHDL_Common/mux5to1_1bit.vhd ../src/VHDL_Common/mux5to1_nbit.vhd ../src/VHDL_Common/Output_registers.vhd ../src/VHDL_Common/register_1bit.vhd ../src/VHDL_Common/register_nbit.vhd ../src/VHDL_Common/relu.vhd ../src/VHDL_Common/saturation.vhd ../src/VHDL_Conv1/CONV1_top.vhd ../src/VHDL_Conv1/Conv1_with_CU.vhd ../src/VHDL_Conv1/Conv_layer_1.vhd ../src/VHDL_Conv1/Counter_14_c.vhd ../src/VHDL_Conv1/CU_conv1.vhd ../src/VHDL_Conv1/flipflop.vhd ../src/VHDL_Conv1/full_adder.vhd ../src/VHDL_Conv1/max_pooling.vhd ../src/VHDL_Conv1/precomputation_conv.vhd ../src/VHDL_Conv1/relu_conv.vhd ../src/VHDL_Conv1/shift_reg_32x8bit_mux.vhd ../src/VHDL_Conv1/shift_reg_5x32x8bit_4out.vhd ../src/VHDL_Conv2/CONV2_top.vhd ../src/VHDL_Conv2/conv2_with_CU.vhd ../src/VHDL_Conv2/Conv_layer3.vhd ../src/VHDL_Conv2/counter.vhd ../src/VHDL_Conv2/CU_conv2.vhd ../src/VHDL_Conv2/flipflop_rst.vhd ../src/VHDL_Conv2/mux14to1_nbit.vhd ../src/VHDL_Conv2/one_hot_dec.vhd ../src/VHDL_Conv2/pooling_comparator.vhd ../src/VHDL_Conv2/pooling_layer4_cu.vhd ../src/VHDL_Conv2/pooling_layer4_dp.vhd ../src/VHDL_Conv2/pooling_layer4.vhd ../src/VHDL_Conv2/register_file.vhd ../src/VHDL_Conv2/shift_reg_14xNbit.vhd ../src/VHDL_Conv2/shift_reg_5x14xNbit.vhd ../src/VHDL_FC1/CU_FC1.vhd ../src/VHDL_FC1/decode_3to5.vhd ../src/VHDL_FC1/FC1_top.vhd ../src/VHDL_FC1/Fully_connected_Layer_1.vhd ../src/VHDL_FC1/mux400to1_nbit.vhd ../src/VHDL_FC2/CU_FC2.vhd ../src/VHDL_FC2/decode_2to4.vhd ../src/VHDL_FC2/FC2_top.vhd ../src/VHDL_FC2/Fully_connected_Layer_2.vhd ../src/VHDL_FC2/mux120to1_nbit.vhd ../src/VHDL_FC3/CU_FC3.vhd ../src/VHDL_FC3/FC3_top.vhd ../src/VHDL_FC3/Fully_connected_Layer_3.vhd ../src/VHDL_FC3/mux84to1_nbit.vhd}


# preserviamo i nomi delle netlist della rete
set power_preserve_rtl_hier_names true

# elaborazione dei file, viene data la top entity
elaborate $top_entity -arch structural -lib WORK > $out_dir/elaborate.txt

# comandi aggiunti ora per molteplici istance dello stesso blocco
uniquify
link

# creo il clock di sistema, in ns
create_clock -name MY_CLK -period $period CLK

# poichè il clock è un segnale particolare
# setto la proprietà don't touch
# ciò è fatto perchè col comando ungroup vengono modificate tutte
# le celle tranne quelle dont_touch
set_dont_touch_network MY_CLK
# setto l'incertezza del clock
set_clock_uncertainty 0.07 [get_clocks MY_CLK]
# setto in ritardo di tutti gli ingressi, che si suppone uguale
set_input_delay 0.5 -max -clock MY_CLK [ remove_from_collection [all_inputs] CLK]
# setto il ritardo di tutte le uscite
set_output_delay 0.5 -max -clock MY_CLK [all_outputs]

# setto il carico di ciascun uscita che si suppone uguale a quello 
#  di un buffer
set OLOAD [load_of NangateOpenCellLibrary/BUF_X4/A] 
set_load $OLOAD [all_outputs]

#ungroup -all -flatten

# compilo
#compile_ultra -exact_map -gate_clock > $out_dir/compile$ext.txt
#compile_ultra -exact_map > $out_dir/compile$ext.txt
compile -exact_map > $out_dir/compile$ext.txt

check_design

report_timing > $out_dir/report_timing$ext.txt

report_area > $out_dir/report_area$ext.txt

report_power > $out_dir/report_power$ext.txt

# salvo la sintesi corrente
write_partition -type post -destination synt_db

quit
